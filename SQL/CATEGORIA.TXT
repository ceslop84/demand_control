SELECT 
  SUM(DIA_DE_TRABALHO.QUANTIDADE_TRABALHO) AS TRABALHO,
  EMPREENDIMENTO.DESCRICAO AS EMPREENDIMENTO,
  COUNT(DEMANDA.ID) AS NUMERO_DEMANDAS
FROM
  TRABALHO
  INNER JOIN TEMPO ON (TRABALHO.ID = TEMPO.TRABALHO)
  INNER JOIN DIA_DE_TRABALHO ON (TEMPO.ID = DIA_DE_TRABALHO.TEMPO)
  INNER JOIN DEMANDA ON (TRABALHO.DEMANDA = DEMANDA.ID)
  INNER JOIN EMPREENDIMENTO ON (DEMANDA.EMPREENDIMENTO = EMPREENDIMENTO.ID)
WHERE
  DIA < '2014-03-01' AND DIA > '2014-03-31'
GROUP BY
  EMPREENDIMENTO.DESCRICAO
ORDER BY
  EMPREENDIMENTO.DESCRICAO
